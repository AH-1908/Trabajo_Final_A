<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
	<link rel="stylesheet" href="estilos.css"> 
	<title>Reproductor Spotify</title>
</head>
<body>
    <div class="tab">
        <button class="tablinks" onclick="openService(event, 'Spotify')"><img src="spotify.png" alt="Spotify"> Spotify</button>
        <button class="tablinks" onclick="openService(event, 'iTunes')"><img src="itunes.png" alt="iTunes"> iTunes</button>
        <button class="tablinks" onclick="openService(event, 'YouTubeMusic')"><img src="ytmusic.png" alt="YouTube Music"> YouTube Music</button>
    </div>
    
    <div id="Spotify" class="tabcontent">
        <div class="search-container">
            <input type="text" id="searchQuery" placeholder="Search for an artist, playlist, or song">
            <div class="button-container">
                <button onclick="searchArtist()">Search Artist</button>
                <button onclick="searchPlaylist()">Search Playlist</button>
                <button onclick="searchTrack()">Search Track</button>
            </div>
        </div>
        <div id="results" class="results-container">
            <div class="column" id="playlistColumn">
                <h2>PLAYLISTS</h2>
                <iframe id="playlistIframe" src="" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
            </div>
            <div class="column" id="artistColumn">
                <h2>ARTIST</h2>
                <iframe id="artistIframe" src="" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
            </div>
        </div>
        <div id="trackResults">
            <h2>TRACKS</h2>
            <iframe id="trackIframe" src="" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>
    </div>
    
    <div id="iTunes" class="tabcontent">
        <form id="searchForm">
            <label for="artistName">Nombre del Artista:</label>
            <input type="text" id="artistName" name="artistName">
            <button type="submit">Buscar Letras</button>
        </form>
        
        <div id="lyrics"></div>
        
        <script>
        document.getElementById('searchForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const artistName = document.getElementById('artistName').value.trim();
            
            if (!artistName) {
                alert('Por favor ingresa el nombre del artista.');
                return;
            }
            
            buscarLetras(artistName);
        });
        
        function buscarLetras(artistName) {
            const token = "pm--zfdMfysUC4Vev1YNMzUW9QBDcd_Vh1rmJe7mMHlyxo1MOhhYSrpkLY9M4djQ";
            const apiUrl = `https://api.genius.com/search?q=${encodeURIComponent(artistName)}&access_token=${token}`;
        
            fetch(apiUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Error ${response.status}: ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.meta.status === 200 && data.response.hits.length > 0) {
                        const songUrl = data.response.hits[0].result.url;
                        obtenerLetras(songUrl);
                    } else {
                        throw new Error("No se encontró la canción.");
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Ocurrió un error al buscar la canción.');
                });
        }
        
        function obtenerLetras(songUrl) {
            fetch(`/get_lyrics?url=${encodeURIComponent(songUrl)}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Error ${response.status}: ${response.statusText}`);
                    }
                    return response.text();
                })
                .then(lyrics => {
                    document.getElementById('lyrics').textContent = lyrics;
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Ocurrió un error al obtener las letras de la canción.');
                });
        }
        </script>
    </div>
    
    <div id="YouTubeMusic" class="tabcontent">
        <h1>Buscar Videos Musicales en YouTube</h1>

    <form id="searchForm">
        <input type="text" id="artistName" placeholder="Nombre del Artista">
        <button type="submit">Buscar</button>
    </form>

    <div id="results"></div>

    </div>
    
    <script src="script.js"></script>
</body>
</html>